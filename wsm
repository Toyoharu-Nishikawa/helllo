import {Worksheet, WorksheetExpress,setExpressAPI } from "../../workbench/class/Worksheet.js"
import {WorkbenchAppForMini} from "./WorkbenchAppForMini.js"

export const WorksheetForMini = class extends Worksheet{
  constructor(dom){
    super()
    this.fullNameToAppObjMap = new Map()
    this.idToAppObjMap = new Map()
    this.fullNameToIdMap = new Map()
    this.connectionMap = new Map()
    this.appIdCountMap = new Map()
    this.express = new WorksheetExpress()
    if(dom instanceof HTMLElement){
      this.dom = dom
    }
    else{
      const elem = document.createElement("div")
      elem.id="MiniWorkbench"
      document.body.append(elem)
      this.dom = elem
    }
    this.dom.style.display="none"
    this.initialize()
  }
  add(name){
    const appIdCountMap = this.appIdCountMap
    const appId = appIdCountMap.has(name) ? appIdCountMap.get(name) + 1 : 0
    appIdCountMap.set(name, appId)

    const dom = this.dom
    const appObj = new WorkbenchAppForMini(name,appId,this, dom)
    const fullName = appObj.fullName
    this.fullNameToAppObjMap.set(fullName, appObj)

    return appObj
  }
} 
